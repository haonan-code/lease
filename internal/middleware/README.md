# 中间件组件 (Middleware Components)

## 简介

中间件组件用于处理 HTTP 请求的预处理和后处理，提供了一系列可复用的功能模块，如认证、日志记录、安全防护等。中间件按照注册顺序依次执行，形成请求处理管道。

## 中间件目录结构

- **auth/**: 认证相关中间件，包含 JWT 认证实现，用于保护需要登录的 API 接口
- **cors/**: 跨域资源共享(CORS)中间件，处理跨域请求的安全访问策略
- **error/**: 全局错误处理中间件，统一处理和格式化 API 错误响应
- **logger/**: 日志记录中间件，记录 HTTP 请求和响应信息
- **recover/**: 全局异常恢复中间件，防止服务因未捕获的异常而崩溃
- **secure/**: 安全相关中间件，包含 XSS 防御和 CSRF 防御功能
- **swagger/**: Swagger API 文档中间件，提供 API 文档访问支持

## 核心功能

- 请求与响应的预处理和后处理
- 全局错误处理和异常恢复
- 访问认证与鉴权
- 跨域资源共享控制
- 安全防御（XSS、CSRF）
- 请求日志记录
- API 文档支持

## 使用方式

中间件在主程序启动时通过 `middleware.New()` 函数统一注册到 Echo 框架：

```go
// 初始化并注册所有中间件
middleware.New(app)
```

中间件执行顺序：

1. 全局错误处理
2. CORS 跨域资源共享
3. 请求 ID 生成
4. 日志记录
5. XSS 防御
6. CSRF 防御
7. 异常恢复
8. Swagger 文档支持

特定路由的认证中间件可以单独应用：

```go
// 对特定路由组应用 JWT 认证
api := app.Group("/api")
api.Use(auth_middleware.AuthMiddleware())
```
